model:
    provider: openai_like
    id: glm-4.7
    base_url: https://api.z.ai/api/coding/paas/v4
    api_key_env: GLM_API_KEY
    structured_outputs: off

discord:
    token_env: DISCORD_BOT_TOKEN

memory:
    mode: automatic
    db_file: data/bitdoze.db
    add_history_to_context: true
    num_history_runs: 8
    read_chat_history: true
    search_session_history: true
    num_history_sessions: 3
    add_memories_to_context: true
    enable_session_summaries: false
    add_session_summary_to_context: false
    summary_prompt: |
        You are generating a session summary. Return ONLY a JSON object.
        Required keys:
          - summary: string (required, must be present)
          - topics: array of strings (optional)
        Use lowercase keys exactly as shown. Do not add extra keys or prose.
    summary_request_message: "Return JSON only. Include the required key: summary."

learning:
    enabled: true
    mode: always # always | agentic | propose | hitl
    add_to_context: true
    stores:
        user_profile: true
        user_memory: true
        session_context: false
        entity_memory: false
        learned_knowledge: false
        decision_log: false

toolkits:
    web_search:
        enabled: true
        backend: duckduckgo
    hackernews:
        enabled: true
    website:
        enabled: true
    github:
        enabled: true
        token_env: GITHUB_ACCESS_TOKEN
        base_url: null
    youtube:
        enabled: true
        languages: [en]
    file:
        enabled: true
        base_dir: workspace
    shell:
        enabled: true
        base_dir: workspace
    discord:
        enabled: true

heartbeat:
    enabled: true
    interval_minutes: 30
    quiet_ack: HEARTBEAT_OK
    prompt_path: workspace/HEARTBEAT.md
    channel_id: null

cron:
    path: workspace/CRON.yaml

soul:
    path: workspace/SOUL.md

context:
    add_datetime: true
    timezone_identifier: Europe/Bucharest
    agents_path: workspace/AGENTS.md
    user_path: workspace/USER.md
    memory_dir: workspace/memory
    long_memory_path: workspace/MEMORY.md
    main_session_scope: dm_only

agents:
    base_instructions: |
        You have access to a separate research agent named "research" that is better suited
        for heavy web research (HackerNews, GitHub, YouTube). If a request requires deep
        research, route it by asking the user to prefix their message with "research:" or
        explicitly mentioning "agent:research".
    default: main
    definitions:
        - name: main
          tools:
              [
                  web_search,
                  hackernews,
                  website,
                  github,
                  youtube,
                  file,
                  shell,
                  discord,
              ]
          skills: []
          instructions: ""
        - name: architect
          tools: [web_search, website, file, shell]
          skills: []
          instructions: |
              You are the architect agent.
              Focus on high-level design, planning, and tradeoffs.
              Produce a clear plan before implementation steps.
        - name: manager
          tools: [web_search, website, github, file, shell]
          skills: []
          instructions: |
              You are the manager agent.
              Coordinate architect and engineer inputs, then produce the final response.
              Resolve conflicts and keep the answer concise and actionable.
        - name: engineer
          tools: [web_search, website, github, file, shell]
          skills: []
          instructions: |
              You are the software engineer agent.
              Focus on implementation details, code changes, and tests.
              Ask clarifying questions when requirements are ambiguous.
        - name: research
          tools: [web_search, hackernews, website, github, youtube, file, shell]
          skills: [web-research]
          instructions: ""
    routing:
        rules:
            - agent: manager
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["manage"]
            - agent: architect
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["plan"]
            - agent: engineer
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["build"]
            - agent: research
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["research:"]
              starts_with: ["research:"]

skills:
    enabled: true
    directories: [skills]
