model:
    provider: openai_like
    id: stepfun/step-3.5-flash:free
    base_url: https://openrouter.ai/api/v1
    api_key_env: OPENAI_API_KEY
    structured_outputs: auto

discord:
    token_env: DISCORD_BOT_TOKEN

memory:
    mode: automatic
    db_file: data/bitdoze.db
    add_history_to_context: true
    num_history_runs: 8
    read_chat_history: true
    search_session_history: true
    num_history_sessions: 3
    add_memories_to_context: true
    enable_session_summaries: true
    add_session_summary_to_context: true
    summary_prompt: |
        You are generating a session summary. Return ONLY a JSON object.
        Required keys:
          - summary: string (required, must be present)
          - topics: array of strings (optional)
        Use lowercase keys exactly as shown. Do not add extra keys or prose.
    summary_request_message: "Return JSON only. Include the required key: summary."

learning:
    enabled: true
    mode: always # always | agentic | propose | hitl
    add_to_context: true
    stores:
        user_profile: true
        user_memory: true
        session_context: false
        entity_memory: false
        learned_knowledge: false
        decision_log: false

toolkits:
    web_search:
        enabled: true
        backend: duckduckgo
    hackernews:
        enabled: true
    website:
        enabled: true
    github:
        enabled: true
        token_env: GITHUB_ACCESS_TOKEN
        base_url: null
    youtube:
        enabled: true
        languages: [en]
    file:
        enabled: true
        base_dir: workspace
    shell:
        enabled: true
        base_dir: workspace
    discord:
        enabled: true

heartbeat:
    enabled: true
    interval_minutes: 30
    quiet_ack: HEARTBEAT_OK
    prompt_path: workspace/HEARTBEAT.md
    session_scope: isolated # isolated | shared
    agent: heartbeat # optional: run heartbeat with a dedicated low-context agent
    channel_id: null

cron:
    path: workspace/CRON.yaml

soul:
    path: workspace/SOUL.md

context:
    add_datetime: true
    timezone_identifier: Europe/Bucharest
    agents_path: workspace/AGENTS.md
    user_path: workspace/USER.md
    memory_dir: workspace/memory
    long_memory_path: workspace/MEMORY.md
    main_session_scope: dm_only

agents:
    base_instructions: |
        You may be orchestrated inside teams. Delegate planning-heavy tasks to architect and
        implementation-heavy tasks to software-engineer when appropriate.
    workspace_dir: workspace/agents
    aliases:
        engineer: software-engineer
        software-enginner: software-engineer
    default: main
    definitions:
        - name: main
          tools:
              [
                  web_search,
                  hackernews,
                  website,
                  github,
                  youtube,
                  file,
                  shell,
                  discord,
              ]
          skills: []
          instructions: ""
        - name: research
          tools: [web_search, hackernews, website, github, youtube, file, shell]
          skills: [web-research]
          instructions: ""
        - name: heartbeat
          tools: []
          skills: []
          memory:
              mode: disabled
              add_history_to_context: false
              read_chat_history: false
              search_session_history: false
              num_history_sessions: 0
              add_memories_to_context: false
              enable_session_summaries: false
              add_session_summary_to_context: false
          learning:
              enabled: false
          instructions: |
              You are a lightweight heartbeat monitor.
              Never call tools for heartbeat checks.
              If there is nothing to report, respond exactly: HEARTBEAT_OK
              If there is something to report, respond in 1-3 short bullets.
    routing:
        rules:
            - agent: delivery-team
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["manage", "orchestrate", "team:"]
              starts_with: ["team:"]
            - agent: research
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["research:"]
              starts_with: ["research:"]

teams:
    definitions:
        - name: delivery-team
          members: [architect, software-engineer]
          respond_directly: true
          determine_input_for_members: true
          delegate_to_all_members: false
          add_member_tools_to_context: true
          add_team_history_to_members: true
          num_team_history_runs: 5
          show_members_responses: false
          debug_mode: false
          instructions: |
              You are the delivery team coordinator.
              Produce one final answer after collecting architecture and implementation input.
              Keep output concise, actionable, and include next steps.

skills:
    enabled: true
    directories: [skills]
