model:
    provider: openai_like
    id: stepfun/step-3.5-flash:free
    base_url: https://openrouter.ai/api/v1
    api_key_env: OPENAI_API_KEY
    structured_outputs: auto

discord:
    token_env: DISCORD_BOT_TOKEN

memory:
    mode: automatic
    db_file: data/bitdoze.db
    add_history_to_context: true
    num_history_runs: 8
    read_chat_history: true
    search_session_history: true
    num_history_sessions: 3
    add_memories_to_context: true
    enable_session_summaries: true
    add_session_summary_to_context: true
    summary_prompt: |
        You are generating a session summary. Return ONLY a JSON object.
        Required keys:
          - summary: string (required, must be present)
          - topics: array of strings (optional)
        Use lowercase keys exactly as shown. Do not add extra keys or prose.
    summary_request_message: "Return JSON only. Include the required key: summary."

learning:
    enabled: true
    mode: always # always | agentic | propose | hitl
    add_to_context: true
    stores:
        user_profile: true
        user_memory: true
        session_context: false
        entity_memory: false
        learned_knowledge: false
        decision_log: false

toolkits:
    web_search:
        enabled: true
        backend: duckduckgo
    hackernews:
        enabled: true
    website:
        enabled: true
    github:
        enabled: true
        token_env: GITHUB_ACCESS_TOKEN
        base_url: null
    youtube:
        enabled: true
        languages: [en]
    file:
        enabled: true
        base_dir: workspace
    shell:
        enabled: true
        base_dir: workspace
    discord:
        enabled: true
    tasks:
        enabled: true
    collaboration:
        enabled: true
    bridge:
        enabled: true

heartbeat:
    enabled: true
    interval_minutes: 30
    quiet_ack: HEARTBEAT_OK
    prompt_path: workspace/HEARTBEAT.md
    channel_id: null

cron:
    path: workspace/CRON.yaml

soul:
    path: workspace/SOUL.md

context:
    add_datetime: true
    timezone_identifier: Europe/Bucharest
    agents_path: workspace/AGENTS.md
    tasks_dir: workspace/tasks
    tasks_path: workspace/tasks/README.md
    specs_dir: workspace/team/specs
    handoffs_dir: workspace/team/handoffs
    team_readme_path: workspace/team/README.md
    user_path: workspace/USER.md
    memory_dir: workspace/memory
    long_memory_path: workspace/MEMORY.md
    main_session_scope: dm_only

agents:
    team_directory: workspace/agents
    per_agent_workspace: false
    base_instructions: |
        You have access to a separate research agent named "research" that is better suited
        for heavy web research (HackerNews, GitHub, YouTube). If a request requires deep
        research, route it by asking the user to prefix their message with "research:" or
        explicitly mentioning "agent:research".
    default: build-team
    definitions:
        - name: main
          tools:
              [
                  web_search,
                  hackernews,
                  website,
                  github,
                  youtube,
                  file,
                  shell,
                  tasks,
                  collaboration,
                  bridge,
                  discord,
              ]
          skills: []
          instructions: ""
        - name: research
          tools: [web_search, hackernews, website, github, youtube]
          skills: [web-research]
          instructions: ""
    routing:
        rules:
            - agent: research
              channel_ids: []
              user_ids: []
              guild_ids: []
              contains: ["research:"]
              starts_with: ["research:"]

    # External agent team folder support:
    # - place each agent in workspace/agents/<agent-name>/
    # - required file: agent-config.yml (or .yaml)
    # - optional file: agents.md (local instructions for that agent)
    #
    # Example workspace/agents/architect/agent-config.yml:
    # name: architect
    # model:
    #   id: gpt-4o-mini
    #   base_url: https://openrouter.ai/api/v1
    #   api_key_env: OPENAI_API_KEY
    # tools: [web_search, website, file, shell, tasks, collaboration, bridge]
    # skills: [web-research]
    # workspace: workspace

teams:
    enabled: true
    default: build-team
    base_instructions: |
        You are a coordinated engineering team. Route architecture/planning to architect
        and implementation/testing to software-engineer.
    definitions:
        - name: build-team
          members: [architect, software-engineer]
          tools: [tasks, collaboration, bridge]
          respond_directly: true
          determine_input_for_members: true
          delegate_to_all_members: false
          add_member_tools_to_context: false
          share_member_interactions: true
          instructions: |
              Coordinate through `workspace/tasks/board.yaml`.
              Ensure every substantial request becomes a task with clear owner/status.
              Members must update task status/notes themselves as work progresses.
              Specs must be written only in `workspace/team/specs/`.
              Use `tasks` and `collaboration` tools for task/spec work, not raw file tools.

skills:
    enabled: true
    directories: [skills]
